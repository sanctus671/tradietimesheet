(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{o9FT:function(n,t,s){"use strict";s.r(t);var i=s("CcnG"),l=function(){return function(){}}(),u=s("pMnS"),o=s("oBZk"),e=s("ZZ/e"),r=s("ZYCi"),a=s("Ip0R"),b=s("QaJk"),m=s("ri4K"),c=s("wd/R"),d=function(){function n(n,t,s,i,l,u,o,e){var r=this;this.submissionService=n,this.toastController=t,this.modalController=s,this.router=i,this.authenticationService=l,this.alertCtrl=u,this.ngZone=o,this.platform=e,this.loading=!0,this.submissions=[],this.submittedSubmissions=[],this.weeks=[],this.submissionsByWeek={},this.workTimeByWeek={},this.user={},this.authenticationService.getUserData().subscribe((function(n){r.ngZone.run((function(){r.user=n})),r.weeks=[],r.submissionsByWeek={},r.getSubmissions(),r.getSubmittedSubmissions()}))}return n.prototype.ngOnInit=function(){},n.prototype.ionViewDidEnter=function(){this.weeks=[],this.submissionsByWeek={},this.getSubmissions(),this.getSubmittedSubmissions()},n.prototype.getSubmissions=function(){var n=this;this.submissionService.getLocalSubmissions().then((function(t){n.submissions=t;for(var s=0,i=n.submissions;s<i.length;s++){var l=i[s],u=c(l.submission_date);"Sunday"===u.format("dddd")&&u.subtract(1,"days");var o=u.startOf("week");"Sunday"===o.format("dddd")&&o.add(1,"days");var e=o.format("YYYY-MM-DD");n.weeks.indexOf(e)<0&&(n.weeks.push(e),n.submissionsByWeek[e]=[]);for(var r=!1,a=0,b=n.submissionsByWeek[e];a<b.length;a++)b[a].submission_date===l.submission_date&&(r=!0);r||n.submissionsByWeek[e].push(l),n.submissionsByWeek[e].sort((function(n,t){return new Date(n.submission_date)-new Date(t.submission_date)}))}n.weeks.sort((function(n,t){var s=new Date(n);return new Date(t)-s})),setTimeout((function(){n.loading=!1}),5e3)}))},n.prototype.getSubmittedSubmissions=function(){var n=this;this.submissionService.getSubmissions().then((function(t){n.submittedSubmissions=t,n.workTimeByWeek={};for(var s=0,i=n.submittedSubmissions;s<i.length;s++){var l=i[s],u=c(l.submission_date);"Sunday"===u.format("dddd")&&u.subtract(1,"days");var o=u.startOf("week");"Sunday"===o.format("dddd")&&o.add(1,"days");var e=o.format("YYYY-MM-DD");n.weeks.indexOf(e)<0&&(n.weeks.push(e),n.submissionsByWeek[e]=[]);for(var r=!1,a=0,b=n.submissionsByWeek[e];a<b.length;a++)b[a].submission_date===l.submission_date&&(r=!0);r||n.submissionsByWeek[e].push(l),n.submissionsByWeek[e].sort((function(n,t){return new Date(n.submission_date)-new Date(t.submission_date)}))}n.weeks.sort((function(n,t){var s=new Date(n);return new Date(t)-s})),n.loading=!1}))},n.prototype.calculateWorkTime=function(n){for(var t=0,s=0;s<8;s++){for(var i=c(n).add(s,"days").format("YYYY-MM-DD"),l=0,u=0,o=this.submissions;u<o.length;u++)if((b=o[u]).submission_date===i){var e=b.submission_date+" "+b.start_time;l+=c.duration(c(b.submission_date+" "+b.end_time).diff(c(e))).asMinutes()}for(var r=0,a=this.submittedSubmissions;r<a.length;r++){var b;(b=a[r]).submission_date===i&&(e=b.submission_date+" "+b.start_time,l+=c.duration(c(b.submission_date+" "+b.end_time).diff(c(e))).asMinutes())}l>0&&(l-=30)<0&&(l=0),t+=l}return this.formatMinutes(t)},n.prototype.formatDate=function(n){return c(n).format("DD/MM/YYYY")},n.prototype.formatDatabase=function(n){return c(n).format("YYYY-MM-DD")},n.prototype.formatLongDate=function(n){return c(n).format("dddd Do MMM")},n.prototype.formatFromNow=function(n){return c(n).fromNow()},n.prototype.formatFromNowServer=function(n){var t=-(new Date).getTimezoneOffset();return c(n).add(t,"m").fromNow()},n.prototype.formatMinutes=function(n){var t=n/60,s=Math.floor(t),i=Math.round(60*(t-s));return(s>0?s+" "+(1===s?"hour":"hours")+" ":"")+(i>0?i+" "+(1===i?"minute":"minutes"):"")},n}(),f=i.rb({encapsulation:0,styles:[[".submissions[_ngcontent-%COMP%]   .submissions__list[_ngcontent-%COMP%]{margin-top:5px;margin-bottom:15px;border-bottom:1px solid #dedede;padding-bottom:40px}.submissions[_ngcontent-%COMP%]   .submissions__list[_ngcontent-%COMP%]   ion-list-header[_ngcontent-%COMP%]{font-weight:600;font-size:16px}.submissions[_ngcontent-%COMP%]   .submissions__list[_ngcontent-%COMP%]   .submissions__list__total[_ngcontent-%COMP%]{padding:0 15px;font-weight:700;margin-top:20px;font-size:14px}.submissions[_ngcontent-%COMP%]   .submissions__loading[_ngcontent-%COMP%]{text-align:center;margin-top:60px}"]],data:{}});function p(n){return i.Lb(0,[(n()(),i.tb(0,0,null,null,2,"div",[["class","submissions__loading"]],null,null,null,null,null)),(n()(),i.tb(1,0,null,null,1,"ion-spinner",[["color","primary"]],null,null,null,o.J,o.o)),i.sb(2,49152,null,0,e.rb,[i.h,i.k,i.z],{color:[0,"color"]},null)],(function(n,t){n(t,2,0,"primary")}),null)}function h(n){return i.Lb(0,[(n()(),i.tb(0,0,null,null,10,"div",[],null,null,null,null,null)),(n()(),i.tb(1,0,null,null,9,"ion-item",[["detail",""],["routerDirection","forward"]],null,[[null,"click"]],(function(n,t,s){var l=!0;return"click"===t&&(l=!1!==i.Eb(n,3).onClick()&&l),"click"===t&&(l=!1!==i.Eb(n,6).onClick(s)&&l),l}),o.F,o.k)),i.sb(2,49152,null,0,e.G,[i.h,i.k,i.z],{detail:[0,"detail"],routerDirection:[1,"routerDirection"]},null),i.sb(3,16384,null,0,r.n,[r.m,r.a,[8,null],i.D,i.k],{queryParams:[0,"queryParams"],routerLink:[1,"routerLink"]},null),i.Gb(4,{date:0}),i.Fb(5,1),i.sb(6,737280,null,0,e.Kb,[a.g,e.Hb,i.k,r.m,[2,r.n]],{routerDirection:[0,"routerDirection"]},null),(n()(),i.tb(7,0,null,0,3,"ion-label",[],null,null,null,o.G,o.l)),i.sb(8,49152,null,0,e.M,[i.h,i.k,i.z],null,null),(n()(),i.tb(9,0,null,0,1,"h2",[],null,null,null,null,null)),(n()(),i.Kb(10,null,["",""]))],(function(n,t){var s=t.component;n(t,2,0,"","forward");var i=n(t,4,0,s.formatDatabase(t.context.$implicit.submission_date)),l=n(t,5,0,"/timesheet-date");n(t,3,0,i,l),n(t,6,0,"forward")}),(function(n,t){n(t,10,0,t.component.formatLongDate(t.context.$implicit.submission_date))}))}function g(n){return i.Lb(0,[(n()(),i.tb(0,0,null,null,8,"ion-list",[["class","submissions__list"]],null,null,null,o.I,o.m)),i.sb(1,49152,null,0,e.N,[i.h,i.k,i.z],null,null),(n()(),i.tb(2,0,null,0,2,"ion-list-header",[],null,null,null,o.H,o.n)),i.sb(3,49152,null,0,e.O,[i.h,i.k,i.z],null,null),(n()(),i.Kb(4,0,[" Week of "," "])),(n()(),i.ib(16777216,null,0,1,null,h)),i.sb(6,278528,null,0,a.i,[i.O,i.L,i.s],{ngForOf:[0,"ngForOf"]},null),(n()(),i.tb(7,0,null,0,1,"div",[["class","submissions__list__total"]],null,null,null,null,null)),(n()(),i.Kb(8,null,[" Total work time is "," "]))],(function(n,t){n(t,6,0,t.component.submissionsByWeek[t.context.$implicit])}),(function(n,t){var s=t.component;n(t,4,0,s.formatDate(t.context.$implicit)),n(t,8,0,s.calculateWorkTime(t.context.$implicit))}))}function k(n){return i.Lb(0,[(n()(),i.tb(0,0,null,null,2,"div",[],null,null,null,null,null)),(n()(),i.ib(16777216,null,null,1,null,g)),i.sb(2,278528,null,0,a.i,[i.O,i.L,i.s],{ngForOf:[0,"ngForOf"]},null)],(function(n,t){n(t,2,0,t.component.weeks)}),null)}function _(n){return i.Lb(0,[(n()(),i.tb(0,0,null,null,6,"ion-header",[],null,null,null,o.C,o.h)),i.sb(1,49152,null,0,e.A,[i.h,i.k,i.z],null,null),(n()(),i.tb(2,0,null,0,4,"ion-toolbar",[["color","primary"]],null,null,null,o.P,o.u)),i.sb(3,49152,null,0,e.Bb,[i.h,i.k,i.z],{color:[0,"color"]},null),(n()(),i.tb(4,0,null,0,2,"ion-title",[],null,null,null,o.O,o.t)),i.sb(5,49152,null,0,e.zb,[i.h,i.k,i.z],null,null),(n()(),i.Kb(-1,0,[" Submissions "])),(n()(),i.tb(7,0,null,null,5,"ion-content",[["class","submissions"]],null,null,null,o.z,o.e)),i.sb(8,49152,null,0,e.t,[i.h,i.k,i.z],null,null),(n()(),i.ib(16777216,null,0,1,null,p)),i.sb(10,16384,null,0,a.j,[i.O,i.L],{ngIf:[0,"ngIf"]},null),(n()(),i.ib(16777216,null,0,1,null,k)),i.sb(12,16384,null,0,a.j,[i.O,i.L],{ngIf:[0,"ngIf"]},null)],(function(n,t){var s=t.component;n(t,3,0,"primary"),n(t,10,0,s.loading),n(t,12,0,!s.loading)}),null)}function w(n){return i.Lb(0,[(n()(),i.tb(0,0,null,null,1,"app-submissions",[],null,null,null,_,f)),i.sb(1,114688,null,0,d,[b.a,e.Nb,e.Gb,r.m,m.a,e.a,i.z,e.Ib],null,null)],(function(n,t){n(t,1,0)}),null)}var y=i.pb("app-submissions",d,w,{},{},[]),v=s("gIcY"),D=function(){return function(){}}();s.d(t,"SubmissionsPageModuleNgFactory",(function(){return C}));var C=i.qb(l,[],(function(n){return i.Bb([i.Cb(512,i.j,i.bb,[[8,[u.a,y]],[3,i.j],i.x]),i.Cb(4608,a.l,a.k,[i.u,[2,a.w]]),i.Cb(4608,v.j,v.j,[]),i.Cb(4608,e.b,e.b,[i.z,i.g]),i.Cb(4608,e.Gb,e.Gb,[e.b,i.j,i.q]),i.Cb(4608,e.Jb,e.Jb,[e.b,i.j,i.q]),i.Cb(1073742336,a.b,a.b,[]),i.Cb(1073742336,v.i,v.i,[]),i.Cb(1073742336,v.b,v.b,[]),i.Cb(1073742336,e.Db,e.Db,[]),i.Cb(1073742336,r.p,r.p,[[2,r.u],[2,r.m]]),i.Cb(1073742336,D,D,[]),i.Cb(1073742336,l,l,[]),i.Cb(1024,r.k,(function(){return[[{path:"",component:d}]]}),[])])}))}}]);